# Smart Contract Event Indexer - è¯¦ç»†é¡¹ç›®è®¡åˆ’æ–‡æ¡£

åŸºäºéœ€æ±‚æ–‡æ¡£å’Œ **Mono-repo + Microservices** æ¶æ„çš„å®Œæ•´å®æ–½è®¡åˆ’ã€‚

---

## ğŸ“‹ é¡¹ç›®æ¶æ„æ¦‚è§ˆ

### Microservices æ‹†åˆ†ç­–ç•¥

```
mono-repo/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ indexer-service/      # åŒºå—é“¾äº‹ä»¶ç´¢å¼•æœåŠ¡
â”‚   â”œâ”€â”€ api-gateway/          # GraphQL/REST APIç½‘å…³
â”‚   â”œâ”€â”€ query-service/        # æŸ¥è¯¢ä¼˜åŒ–å’Œç¼“å­˜æœåŠ¡
â”‚   â””â”€â”€ admin-service/        # ç®¡ç†åå°æœåŠ¡
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ proto/                # gRPCåè®®å®šä¹‰
â”‚   â”œâ”€â”€ models/               # å…±äº«æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ utils/                # é€šç”¨å·¥å…·åº“
â”‚   â””â”€â”€ config/               # å…±äº«é…ç½®
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ docker/               # Dockeré…ç½®
â”‚   â”œâ”€â”€ k8s/                  # Kubernetes manifests
â”‚   â””â”€â”€ terraform/            # åŸºç¡€è®¾æ–½å³ä»£ç 
â””â”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
```

### æœåŠ¡èŒè´£åˆ’åˆ†

| æœåŠ¡ | èŒè´£ | æŠ€æœ¯æ ˆ | ç«¯å£ |
|------|------|--------|------|
| **indexer-service** | ç›‘å¬åŒºå—é“¾ã€è§£æäº‹ä»¶ã€å†™å…¥æ•°æ®åº“ | Go + go-ethereum | 8080 |
| **api-gateway** | å¯¹å¤–APIæ¥å£ã€è®¤è¯ã€é™æµ | Go + gqlgen + Gin | 8000 |
| **query-service** | æŸ¥è¯¢ä¼˜åŒ–ã€èšåˆè®¡ç®—ã€ç¼“å­˜ | Go + Redis | 8081 |
| **admin-service** | ç®¡ç†é…ç½®ã€ç›‘æ§é¢æ¿ã€å¥åº·æ£€æŸ¥ | Go + React (å‰ç«¯) | 8082 |

---

## ğŸ”„ Git å·¥ä½œæµå’Œæäº¤ç­–ç•¥

### æ ¸å¿ƒåŸåˆ™

**åŸå­åŒ–æäº¤**: æ¯ä¸ªå­ä»»åŠ¡å®Œæˆåç«‹å³æäº¤ï¼Œä¿æŒæäº¤å†å²çš„æ¸…æ™°å’Œå¯å®¡æŸ¥æ€§ã€‚

**æäº¤æ ¼å¼**: éµå¾ª Conventional Commits è§„èŒƒ
```bash
type(scope): description

è¯¦ç»†æè¿°:
- å…·ä½“å˜æ›´å†…å®¹
- å½±å“èŒƒå›´
- ä¾èµ–å…³ç³»

Resolves: Phase X Task Y - ä»»åŠ¡æè¿°
```

### é˜¶æ®µå¼€å‘æ¨¡å¼

æ¯ä¸ªé˜¶æ®µåŒ…å«å¤šä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡å®Œæˆåç‹¬ç«‹æäº¤ï¼š

```
Phase 3: API Layer Development
â”œâ”€â”€ Task 1: GraphQL Schema Design
â”‚   â”œâ”€â”€ feat(graphql): design complete GraphQL schema with custom scalars
â”‚   â””â”€â”€ feat(graphql): configure gqlgen code generation
â”œâ”€â”€ Task 2: gRPC Service Definitions  
â”‚   â”œâ”€â”€ feat(grpc): define QueryService proto interface
â”‚   â””â”€â”€ feat(grpc): define AdminService proto interface
â”œâ”€â”€ Task 3: Query Service Implementation
â”‚   â”œâ”€â”€ feat(query-service): implement gRPC server with interceptors
â”‚   â”œâ”€â”€ feat(query-service): add Redis caching layer
â”‚   â”œâ”€â”€ feat(query-service): build SQL query optimizer
â”‚   â””â”€â”€ feat(query-service): add Prometheus metrics
â””â”€â”€ Task 4: API Gateway Implementation
    â”œâ”€â”€ feat(api-gateway): implement REST API endpoints
    â”œâ”€â”€ feat(api-gateway): add middleware for CORS and logging
    â””â”€â”€ feat(api-gateway): implement health check endpoints
```

### åˆ†æ”¯ç­–ç•¥

- **åŠŸèƒ½åˆ†æ”¯**: `feature/phase-X-description`
- **ä¿®å¤åˆ†æ”¯**: `fix/description`
- **æ–‡æ¡£åˆ†æ”¯**: `docs/description`

### æäº¤æ£€æŸ¥æ¸…å•

æäº¤å‰å¿…é¡»æ£€æŸ¥ï¼š
- [ ] è¿è¡Œæµ‹è¯•: `make test`
- [ ] è¿è¡Œä»£ç æ£€æŸ¥: `make lint`
- [ ] æ£€æŸ¥å˜æ›´: `git diff --cached`
- [ ] ç¡®è®¤æäº¤ä¿¡æ¯æ¸…æ™°å‡†ç¡®
- [ ] ç¡®è®¤åŒ…å«å¿…è¦çš„æµ‹è¯•

è¯¦ç»†çš„å·¥ä½œæµæŒ‡å—è¯·å‚è€ƒ: [Git Workflow Documentation](../development/GIT_WORKFLOW.md)

---

## ğŸ¯ Phase 1: é¡¹ç›®åŸºç¡€è®¾æ–½æ­å»º (Week 1, Day 1-3)

### 1.1 Mono-repo åˆå§‹åŒ–

**ä»»åŠ¡æ¸…å•:**
- [ ] åˆ›å»º mono-repo ç›®å½•ç»“æ„
- [ ] è®¾ç½® Go Workspace (go.work) ç®¡ç†å¤šæ¨¡å—
- [ ] é…ç½® Makefile ç»Ÿä¸€æ„å»ºå‘½ä»¤
- [ ] è®¾ç½® `.gitignore` å’Œ `.editorconfig`
- [ ] åˆå§‹åŒ–ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ (è¯­ä¹‰åŒ–ç‰ˆæœ¬)

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„é¡¹ç›®éª¨æ¶
- å¯è¿è¡Œçš„ `make build` å‘½ä»¤

---

### 1.2 å…±äº«æ¨¡å—å¼€å‘

**ä»»åŠ¡æ¸…å•:**
- [ ] å®šä¹‰å…±äº«æ•°æ®æ¨¡å‹ (Event, Contract, EventArg)
- [ ] åˆ›å»º gRPC proto æ–‡ä»¶å®šä¹‰æœåŠ¡é—´æ¥å£
- [ ] å®ç°é€šç”¨é…ç½®åŠ è½½å™¨ (æ”¯æŒ ENV/YAML)
- [ ] å®ç°é€šç”¨æ—¥å¿—åº“ (ç»“æ„åŒ–æ—¥å¿— + åˆ†çº§)
- [ ] å®ç°é€šç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶

**äº¤ä»˜ç‰©:**
- `shared/models` åŒ…
- `shared/proto` gRPC å®šä¹‰
- `shared/utils` å·¥å…·åº“

---

### 1.3 Docker å¼€å‘ç¯å¢ƒ

**ä»»åŠ¡æ¸…å•:**
- [ ] ç¼–å†™ `docker-compose.yml` (PostgreSQL + Redis + æµ‹è¯•ç½‘èŠ‚ç‚¹)
- [ ] é…ç½® PostgreSQL åˆå§‹åŒ–è„šæœ¬
- [ ] é…ç½® Redis æŒä¹…åŒ–
- [ ] è®¾ç½®æœ¬åœ° Ganache/Hardhat æµ‹è¯•èŠ‚ç‚¹
- [ ] ç¼–å†™æœåŠ¡å¥åº·æ£€æŸ¥è„šæœ¬

**Docker Compose æœåŠ¡æ¸…å•:**
```yaml
services:
  - postgres:15-alpine
  - redis:7-alpine
  - ganache (æˆ– geth-dev)
  - adminer (æ•°æ®åº“ç®¡ç†ç•Œé¢)
```

**äº¤ä»˜ç‰©:**
- ä¸€é”®å¯åŠ¨çš„æœ¬åœ°å¼€å‘ç¯å¢ƒ
- æ•°æ®åº“è¿ç§»è„šæœ¬ v1 (åˆå§‹ schema)

---

## ğŸ”§ Phase 2: Indexer Service æ ¸å¿ƒå¼€å‘ (Week 1 Day 4-7, Week 2 Day 1-3)

### 2.1 åŒºå—é“¾è¿æ¥æ¨¡å—

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°å¤š RPC èŠ‚ç‚¹ç®¡ç†å™¨
  - ä¸»èŠ‚ç‚¹ + Fallback åˆ—è¡¨
  - æ™ºèƒ½åˆ‡æ¢é€»è¾‘
  - å¥åº·æ£€æŸ¥æœºåˆ¶
- [ ] å®ç° WebSocket è®¢é˜…ç®¡ç†
  - æ–­çº¿é‡è¿
  - å¿ƒè·³æ£€æµ‹
- [ ] å®ç°åŒºå—ç›‘å¬å™¨
  - è·å–æœ€æ–°åŒºå—
  - åŒºå—ç¡®è®¤é€»è¾‘ (12å—)
- [ ] ç¼–å†™å•å…ƒæµ‹è¯• (Mock RPC)

**å…³é”®é…ç½®:**
```yaml
rpc:
  primary: "wss://eth-mainnet.g.alchemy.com/v2/YOUR_KEY"
  fallback:
    - "https://rpc.ankr.com/eth"
    - "https://cloudflare-eth.com"
  max_retry: 3
  retry_delay: 5s
```

**äº¤ä»˜ç‰©:**
- ç¨³å®šçš„åŒºå—é“¾è¿æ¥å±‚
- è¦†ç›–ç‡ >70% çš„å•å…ƒæµ‹è¯•

---

### 2.2 äº‹ä»¶è§£ææ¨¡å—

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° ABI è§£æå™¨
  - åŠ è½½åˆçº¦ ABI
  - æå– Event å®šä¹‰
- [ ] å®ç° Event Log è§£æå™¨
  - è§£æ indexed å‚æ•°
  - è§£æ non-indexed å‚æ•°
  - ç±»å‹è½¬æ¢ (BigNumber â†’ String)
- [ ] å®ç°äº‹ä»¶è¿‡æ»¤å™¨
  - æŒ‰åˆçº¦åœ°å€è¿‡æ»¤
  - æŒ‰äº‹ä»¶åç§°è¿‡æ»¤
- [ ] å¤„ç†ç‰¹æ®Šç±»å‹
  - Address checksum è½¬æ¢
  - Bytes è½¬ Hex
  - Tuple ç±»å‹å±•å¼€
- [ ] **å®ç°ç¡®è®¤å—æ£€æŸ¥é€»è¾‘**
  - è¯»å–åˆçº¦çš„ confirm_blocks é…ç½®
  - æ£€æŸ¥äº‹ä»¶æ˜¯å¦è¾¾åˆ°ç¡®è®¤è¦æ±‚
  - æ”¯æŒåˆçº¦çº§åˆ«çš„ä¸åŒç­–ç•¥

**æµ‹è¯•ç”¨ä¾‹:**
- ERC20 Transfer Event
- ERC721 Transfer Event
- Uniswap Swap Event (å¤æ‚å‚æ•°)

**äº¤ä»˜ç‰©:**
- Event Parser æ ¸å¿ƒåº“
- æ”¯æŒå¸¸è§ ERC æ ‡å‡†äº‹ä»¶

---

### 2.3 æ•°æ®æŒä¹…åŒ–æ¨¡å—

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°æ•°æ®åº“è¿æ¥æ± 
- [ ] å®ç° Contract CRUD æ“ä½œ
  - å¹‚ç­‰çš„ AddContract
  - æ›´æ–° current_block
- [ ] å®ç° Event æ‰¹é‡æ’å…¥
  - ä½¿ç”¨ COPY åè®®ä¼˜åŒ–æ€§èƒ½
  - å¤„ç†å†²çª (ON CONFLICT DO NOTHING)
- [ ] å®ç°äº‹åŠ¡ç®¡ç†
  - æ‰¹é‡æ“ä½œåŸå­æ€§
- [ ] å®ç°æ•°æ®åº“è¿ç§»ç®¡ç† (golang-migrate)

**æ€§èƒ½ä¼˜åŒ–ç‚¹:**
- æ‰¹å¤„ç†å¤§å°: 100-500 events/batch
- è¿æ¥æ± : Min 5, Max 20

**äº¤ä»˜ç‰©:**
- é«˜æ€§èƒ½çš„æ•°æ®å­˜å‚¨å±‚
- å®Œæ•´çš„æ•°æ®åº“è¿ç§»è„šæœ¬

---

### 2.4 Chain Reorg å¤„ç†

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°åŒºå—çŠ¶æ€ç¼“å­˜ (Redis)
  - ç¼“å­˜æœ€è¿‘ 100 ä¸ªåŒºå— hash (è¶³å¤Ÿæ£€æµ‹æ·±åº¦ reorg)
- [ ] å®ç° Reorg æ£€æµ‹é€»è¾‘
  - å¯¹æ¯”é“¾ä¸Š block hash ä¸ç¼“å­˜
  - è¯†åˆ«åˆ†å‰ç‚¹
- [ ] å®ç°æ•°æ®å›æ»šæœºåˆ¶
  - åˆ é™¤ block_number > fork_point çš„äº‹ä»¶
  - æ›´æ–° indexer_state
- [ ] å®ç°é‡æ–°ç´¢å¼•é€»è¾‘
  - ä»åˆ†å‰ç‚¹é‡æ–°æ‹‰å–äº‹ä»¶
- [ ] æ·»åŠ  Reorg å‘Šè­¦

**å›æ»šç­–ç•¥:**
```sql
-- å›æ»šåˆ°æŒ‡å®šåŒºå—
DELETE FROM events WHERE block_number > $fork_block;
UPDATE contracts SET current_block = $fork_block;
```

**äº¤ä»˜ç‰©:**
- å¥å£®çš„ Reorg å¤„ç†æœºåˆ¶
- Reorg ç›‘æ§æŒ‡æ ‡

---

### 2.5 ç´¢å¼•å™¨ä¸»æµç¨‹æ•´åˆ

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°ä¸»ç´¢å¼•å¾ªç¯
  - ç›‘å¬æ–°åŒºå—
  - æ‰¹é‡è·å–äº‹ä»¶
  - è§£æ + å­˜å‚¨
  - æ›´æ–°çŠ¶æ€
- [ ] å®ç°æ–­ç‚¹ç»­ä¼ 
  - ä» indexer_state æ¢å¤
  - å¤„ç†æœåŠ¡é‡å¯
- [ ] å®ç°ä¼˜é›…åœæœº
  - å¤„ç†å®Œå½“å‰æ‰¹æ¬¡å†é€€å‡º
  - ä¿å­˜çŠ¶æ€
- [ ] å®ç°å¹¶å‘æ§åˆ¶
  - å¤šåˆçº¦å¹¶å‘ç´¢å¼•
  - Goroutine æ± ç®¡ç†

**é…ç½®å‚æ•°:**
```yaml
indexer:
  batch_size: 100
  default_confirm_blocks: 6  # é»˜è®¤å¹³è¡¡æ¨¡å¼ï¼ˆå¯åœ¨åˆçº¦çº§åˆ«è¦†ç›–ï¼‰
  poll_interval: 6s
  max_concurrent_contracts: 5
  
  # ç¡®è®¤ç­–ç•¥é¢„è®¾
  confirmation_presets:
    realtime: 1   # å®æ—¶æ¨¡å¼: ~12ç§’å»¶è¿Ÿ
    balanced: 6   # å¹³è¡¡æ¨¡å¼: ~72ç§’å»¶è¿Ÿï¼ˆæ¨èï¼‰
    safe: 12      # å®‰å…¨æ¨¡å¼: ~144ç§’å»¶è¿Ÿ
```

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ Indexer Service
- å¯ç›‘æ§çš„æŒ‡æ ‡è¾“å‡º (Prometheus)

---

## ğŸŒ Phase 3: API Gateway å¼€å‘ (Week 2 Day 4-7)

### 3.1 GraphQL Schema å®šä¹‰

**ä»»åŠ¡æ¸…å•:**
- [ ] è®¾è®¡ GraphQL Schema
  - Query ç±»å‹å®šä¹‰
  - Mutation ç±»å‹å®šä¹‰
  - è‡ªå®šä¹‰æ ‡é‡ (DateTime, BigInt)
- [ ] ä½¿ç”¨ gqlgen ç”Ÿæˆä»£ç 
- [ ] å®ç° DataLoader é˜²æ­¢ N+1 æŸ¥è¯¢
- [ ] é…ç½® GraphQL Playground

**æ ¸å¿ƒ Query:**
```graphql
type Query {
  events(filter: EventFilter, pagination: Pagination): EventConnection
  eventsByTransaction(txHash: String!): [Event!]!
  eventsByAddress(address: String!, pagination: Pagination): EventConnection
  contract(address: String!): Contract
  contractStats(address: String!): ContractStats
}

type Mutation {
  addContract(input: AddContractInput!): AddContractPayload!
  removeContract(address: String!): RemoveContractPayload!
  triggerBackfill(address: String!, fromBlock: Int!, toBlock: Int!): BackfillPayload!
}
```

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ GraphQL Schema
- è‡ªåŠ¨ç”Ÿæˆçš„ Resolver æ¡†æ¶

---

### 3.2 gRPC å®¢æˆ·ç«¯å®ç°

**ä»»åŠ¡æ¸…å•:**
- [ ] å®šä¹‰æœåŠ¡é—´ gRPC æ¥å£
- [ ] å®ç° API Gateway â†’ Query Service è°ƒç”¨
- [ ] å®ç° API Gateway â†’ Admin Service è°ƒç”¨
- [ ] é…ç½®è¿æ¥æ± å’Œè¶…æ—¶
- [ ] å®ç°è¯·æ±‚é‡è¯•é€»è¾‘

**gRPC æœåŠ¡å®šä¹‰:**
```protobuf
service QueryService {
  rpc GetEvents(EventQuery) returns (EventResponse);
  rpc GetEventsByAddress(AddressQuery) returns (EventResponse);
  rpc GetContractStats(StatsQuery) returns (StatsResponse);
}
```

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ gRPC å®¢æˆ·ç«¯å°è£…
- æœåŠ¡å‘ç°æœºåˆ¶ (ç¡¬ç¼–ç  â†’ åç»­æ‰©å±• Consul/etcd)

---

### 3.3 GraphQL Resolver å®ç°

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° Query Resolvers
  - events: è°ƒç”¨ Query Service
  - eventsByTransaction: æ•°æ®åº“ç›´æŸ¥
  - eventsByAddress: è°ƒç”¨ Query Service
  - contract: æ•°æ®åº“æŸ¥è¯¢
  - contractStats: è°ƒç”¨ Query Service
- [ ] å®ç° Mutation Resolvers
  - addContract: è°ƒç”¨ Admin Service
  - removeContract: è°ƒç”¨ Admin Service
  - triggerBackfill: è°ƒç”¨ Indexer Service
- [ ] å®ç° Pagination
  - Cursor-based pagination
  - è®¡ç®— totalCount
- [ ] å®ç°é”™è¯¯å¤„ç†
  - ç»Ÿä¸€é”™è¯¯æ ¼å¼
  - gRPC é”™è¯¯è½¬æ¢

**äº¤ä»˜ç‰©:**
- å®Œæ•´åŠŸèƒ½çš„ GraphQL API
- Postman/Insomnia æµ‹è¯•é›†åˆ

---

### 3.4 REST API å®ç° (å¯é€‰)

**ä»»åŠ¡æ¸…å•:**
- [ ] ä½¿ç”¨ Gin æ¡†æ¶å®ç° REST ç«¯ç‚¹
- [ ] å®ç°ä»¥ä¸‹ç«¯ç‚¹:
  - `GET /api/events`
  - `GET /api/events/:txHash`
  - `GET /api/contracts/:address`
  - `POST /api/contracts`
- [ ] å®ç° API ç‰ˆæœ¬æ§åˆ¶ (v1)
- [ ] ç”Ÿæˆ OpenAPI æ–‡æ¡£

**äº¤ä»˜ç‰©:**
- RESTful API (ä¸ GraphQL åŠŸèƒ½å¯¹ç­‰)
- Swagger UI æ–‡æ¡£

---

### 3.5 è®¤è¯ä¸é™æµ

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° API Key è®¤è¯ä¸­é—´ä»¶
- [ ] å®ç°åŸºäº Redis çš„é™æµ
  - æŒ‰ API Key é™æµ
  - æŒ‰ IP é™æµ
- [ ] å®ç°è¯·æ±‚æ—¥å¿—è®°å½•
- [ ] å®ç° CORS é…ç½®

**é™æµç­–ç•¥:**
- å…è´¹: 100 req/min
- Pro: 1000 req/min

**äº¤ä»˜ç‰©:**
- å®‰å…¨çš„ API Gateway
- é™æµç›‘æ§æŒ‡æ ‡

---

## ğŸš€ Phase 4: Query Service å¼€å‘ (Week 3 Day 1-3)

### 4.1 gRPC æœåŠ¡ç«¯å®ç°

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° gRPC Server
- [ ] å®ç° QueryService æ¥å£
  - GetEvents
  - GetEventsByAddress
  - GetContractStats
- [ ] é…ç½®æœåŠ¡ç«¯æ‹¦æˆªå™¨
  - æ—¥å¿—è®°å½•
  - Metrics æ”¶é›†
  - é”™è¯¯æ¢å¤
- [ ] å®ç°å¥åº·æ£€æŸ¥ç«¯ç‚¹

**äº¤ä»˜ç‰©:**
- å¯ç‹¬ç«‹è¿è¡Œçš„ Query Service
- gRPC å¥åº·æ£€æŸ¥

---

### 4.2 æŸ¥è¯¢ä¼˜åŒ–å±‚

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°æ™ºèƒ½æŸ¥è¯¢è·¯ç”±
  - ç®€å•æŸ¥è¯¢ â†’ ç›´æ¥æ•°æ®åº“
  - å¤æ‚æŸ¥è¯¢ â†’ ä¼˜åŒ–åæ‰§è¡Œ
- [ ] å®ç° `eventsByAddress` ä¼˜åŒ–
  - MVP: GIN ç´¢å¼•æŸ¥è¯¢
  - è¯„ä¼°æ˜¯å¦éœ€è¦ event_addresses è¡¨
- [ ] å®ç°æŸ¥è¯¢è®¡åˆ’åˆ†æ
  - è®°å½•æ…¢æŸ¥è¯¢
  - è‡ªåŠ¨å»ºè®®ç´¢å¼•
- [ ] å®ç°æŸ¥è¯¢è¶…æ—¶æ§åˆ¶

**æŸ¥è¯¢æ€§èƒ½ç›®æ ‡:**
- P50 < 50ms
- P95 < 200ms
- P99 < 500ms

**äº¤ä»˜ç‰©:**
- é«˜æ€§èƒ½æŸ¥è¯¢å¼•æ“
- æ…¢æŸ¥è¯¢å‘Šè­¦

---

### 4.3 ç¼“å­˜å±‚å®ç°

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° Redis ç¼“å­˜ç­–ç•¥
  - çƒ­ç‚¹æŸ¥è¯¢ç¼“å­˜ (TTL 30s)
  - åˆçº¦ç»Ÿè®¡ç¼“å­˜ (TTL 5min)
- [ ] å®ç°ç¼“å­˜ Key è®¾è®¡
  - åŒ…å«æŸ¥è¯¢å‚æ•°å“ˆå¸Œ
  - ç‰ˆæœ¬å·æœºåˆ¶
- [ ] å®ç°ç¼“å­˜å¤±æ•ˆç­–ç•¥
  - æ–°äº‹ä»¶å†™å…¥æ—¶ä¸»åŠ¨å¤±æ•ˆ
  - LRU æ·˜æ±°
- [ ] å®ç°ç¼“å­˜ç©¿é€ä¿æŠ¤
  - å¸ƒéš†è¿‡æ»¤å™¨
  - ç©ºç»“æœç¼“å­˜

**ç¼“å­˜å‘½ä¸­ç‡ç›®æ ‡:**
- çƒ­ç‚¹æŸ¥è¯¢: >80%
- æ™®é€šæŸ¥è¯¢: >50%

**äº¤ä»˜ç‰©:**
- å®Œå–„çš„ç¼“å­˜ç³»ç»Ÿ
- ç¼“å­˜ç›‘æ§é¢æ¿

---

### 4.4 èšåˆè®¡ç®—æ¨¡å—

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° ContractStats è®¡ç®—
  - totalEvents
  - latestBlock
  - indexerDelay
  - uniqueAddresses (å¦‚æœé€‚ç”¨)
- [ ] å®ç°è‡ªå®šä¹‰èšåˆæŸ¥è¯¢
  - æŒ‰æ—¶é—´èŒƒå›´ç»Ÿè®¡
  - æŒ‰åœ°å€ç»Ÿè®¡
  - Top N æŸ¥è¯¢
- [ ] å®ç°èšåˆç»“æœç¼“å­˜
- [ ] å®ç°å¢é‡è®¡ç®—ä¼˜åŒ–

**äº¤ä»˜ç‰©:**
- å¼ºå¤§çš„èšåˆæŸ¥è¯¢èƒ½åŠ›
- èšåˆæŸ¥è¯¢æ–‡æ¡£

---

## ğŸ›ï¸ Phase 5: Admin Service å¼€å‘ (Week 3 Day 4-7)

### 5.1 ç®¡ç† API å®ç°

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°åˆçº¦ç®¡ç†æ¥å£
  - æ·»åŠ ç›‘å¬åˆçº¦ (å¹‚ç­‰)
  - åˆ é™¤ç›‘å¬åˆçº¦
  - æ›´æ–°åˆçº¦é…ç½®
  - åˆ—å‡ºæ‰€æœ‰åˆçº¦
- [ ] å®ç°ç´¢å¼•æ§åˆ¶æ¥å£
  - è§¦å‘å†å²å›å¡«
  - æš‚åœ/æ¢å¤ç´¢å¼•
  - é‡ç½®ç´¢å¼•çŠ¶æ€
- [ ] å®ç°ç³»ç»ŸçŠ¶æ€æ¥å£
  - è·å–ç´¢å¼•å™¨çŠ¶æ€
  - è·å–é”™è¯¯æ—¥å¿—
  - è·å–æ€§èƒ½æŒ‡æ ‡
- [ ] å®ç°ç®¡ç†å‘˜è®¤è¯
  - JWT Token
  - è§’è‰²æƒé™æ§åˆ¶

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ç®¡ç† API
- Admin API æ–‡æ¡£

---

### 5.2 å†å²æ•°æ®å›å¡«åŠŸèƒ½

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç° Backfill ä»»åŠ¡è°ƒåº¦
  - é˜Ÿåˆ—ç®¡ç† (Redis)
  - ä»»åŠ¡çŠ¶æ€è¿½è¸ª
- [ ] å®ç°åˆ†å—å›å¡«é€»è¾‘
  - æŒ‰åŒºå—èŒƒå›´åˆ†ç‰‡
  - å¹¶è¡Œå¤„ç†
  - è¿›åº¦æŒä¹…åŒ–
- [ ] å®ç°å›å¡«é™é€Ÿ
  - é¿å… RPC é™æµ
  - æ§åˆ¶æ•°æ®åº“å†™å…¥é€Ÿåº¦
- [ ] å®ç°å›å¡«ç›‘æ§
  - è¿›åº¦ç™¾åˆ†æ¯”
  - ETA è®¡ç®—
  - é”™è¯¯é‡è¯•

**Backfill é…ç½®:**
```yaml
backfill:
  chunk_size: 1000  # æ¯æ¬¡å¤„ç†1000ä¸ªåŒºå—
  max_concurrent: 3
  rate_limit: 100   # 100 req/min
```

**äº¤ä»˜ç‰©:**
- å¯é çš„å†å²æ•°æ®å›å¡«ç³»ç»Ÿ
- å›å¡«è¿›åº¦ç›‘æ§

---

### 5.3 é”™è¯¯æ—¥å¿—ä¸å‘Šè­¦

**ä»»åŠ¡æ¸…å•:**
- [ ] å®ç°é”™è¯¯æ—¥å¿—æ”¶é›†
  - ç´¢å¼•å™¨é”™è¯¯
  - API é”™è¯¯
  - æ•°æ®åº“é”™è¯¯
- [ ] å®ç°é”™è¯¯åˆ†ç±»
  - RPC é”™è¯¯
  - è§£æé”™è¯¯
  - å­˜å‚¨é”™è¯¯
- [ ] å®ç°å‘Šè­¦è§„åˆ™
  - ç´¢å¼•å»¶è¿Ÿ >1min
  - RPC è¿æ¥å¤±è´¥
  - Reorg æ£€æµ‹
- [ ] é›†æˆå‘Šè­¦é€šçŸ¥
  - Slack Webhook
  - Email (å¯é€‰)

**äº¤ä»˜ç‰©:**
- å®Œå–„çš„é”™è¯¯è¿½è¸ªç³»ç»Ÿ
- å®æ—¶å‘Šè­¦æœºåˆ¶

---

### 5.4 ç®¡ç†åå° UI (å¯é€‰)

**ä»»åŠ¡æ¸…å•:**
- [ ] ä½¿ç”¨ React + TypeScript å¼€å‘
- [ ] å®ç°é¡µé¢:
  - Dashboard (ç³»ç»Ÿæ¦‚è§ˆ)
  - Contracts (åˆçº¦ç®¡ç†)
  - Events (äº‹ä»¶æµè§ˆ)
  - Logs (é”™è¯¯æ—¥å¿—)
- [ ] å®ç°æ•°æ®å¯è§†åŒ–
  - ç´¢å¼•é€Ÿåº¦å›¾è¡¨ (Chart.js)
  - äº‹ä»¶ç»Ÿè®¡å›¾è¡¨
- [ ] å®ç°å®æ—¶æ›´æ–° (WebSocket)

**äº¤ä»˜ç‰©:**
- å¯è§†åŒ–ç®¡ç†åå°
- ç”¨æˆ·æ“ä½œæ‰‹å†Œ

---

## ğŸ“Š Phase 6: ç›‘æ§ä¸æµ‹è¯• (Week 4 Day 1-4)

### 6.1 Prometheus Metrics

**ä»»åŠ¡æ¸…å•:**
- [ ] ä¸ºæ¯ä¸ªæœåŠ¡æ·»åŠ  Metrics ç«¯ç‚¹
- [ ] å®šä¹‰å…³é”®æŒ‡æ ‡:
  - **Indexer**: ç´¢å¼•å»¶è¿Ÿã€äº‹ä»¶å¤„ç†é€Ÿç‡ã€RPC è°ƒç”¨æ¬¡æ•°
  - **API Gateway**: è¯·æ±‚æ€»æ•°ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
  - **Query Service**: æŸ¥è¯¢å»¶è¿Ÿã€ç¼“å­˜å‘½ä¸­ç‡
- [ ] å®ç°è‡ªå®šä¹‰ Metrics
  - æŒ‰åˆçº¦çš„äº‹ä»¶æ•°é‡
  - æŒ‰äº‹ä»¶ç±»å‹çš„åˆ†å¸ƒ
- [ ] é…ç½® Prometheus æŠ“å–

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ Metrics é‡‡é›†
- Prometheus é…ç½®æ–‡ä»¶

---

### 6.2 Grafana Dashboard

**ä»»åŠ¡æ¸…å•:**
- [ ] å®‰è£… Grafana
- [ ] åˆ›å»º Dashboard:
  - **ç³»ç»Ÿæ¦‚è§ˆ**: CPUã€å†…å­˜ã€ç½‘ç»œ
  - **ç´¢å¼•å™¨æ€§èƒ½**: å»¶è¿Ÿã€ååé‡ã€Reorg æ¬¡æ•°
  - **API æ€§èƒ½**: QPSã€å»¶è¿Ÿåˆ†å¸ƒã€é”™è¯¯ç‡
  - **æ•°æ®åº“æ€§èƒ½**: è¿æ¥æ•°ã€æŸ¥è¯¢æ—¶é—´ã€æ…¢æŸ¥è¯¢
- [ ] é…ç½®å‘Šè­¦è§„åˆ™
  - ç´¢å¼•å»¶è¿Ÿ >1min å‘Šè­¦
  - API é”™è¯¯ç‡ >1% å‘Šè­¦
  - æ•°æ®åº“è¿æ¥æ± è€—å°½å‘Šè­¦
- [ ] å¯¼å‡º Dashboard JSON

**äº¤ä»˜ç‰©:**
- å¯è§†åŒ–ç›‘æ§é¢æ¿
- å‘Šè­¦é…ç½®

---

### 6.3 å•å…ƒæµ‹è¯•

**ä»»åŠ¡æ¸…å•:**
- [ ] ä¸ºæ¯ä¸ªæœåŠ¡ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘:
  - Event Parser: æµ‹è¯•å„ç§ ABI ç±»å‹
  - Reorg Handler: æ¨¡æ‹Ÿ Reorg åœºæ™¯
  - Query Optimizer: æµ‹è¯•æŸ¥è¯¢æ€§èƒ½
- [ ] ä½¿ç”¨ Mock
  - Mock RPC å®¢æˆ·ç«¯
  - Mock æ•°æ®åº“
  - Mock Redis
- [ ] é…ç½® CI è‡ªåŠ¨è¿è¡Œæµ‹è¯•

**è¦†ç›–ç‡ç›®æ ‡:**
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘: >80%
- API Handlers: >70%
- æ€»ä½“: >75%

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„å•å…ƒæµ‹è¯•å¥—ä»¶
- æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

---

### 6.4 é›†æˆæµ‹è¯•

**ä»»åŠ¡æ¸…å•:**
- [ ] ä½¿ç”¨ Testcontainers å¯åŠ¨ä¾èµ–
  - PostgreSQL
  - Redis
  - Ganache
- [ ] ç¼–å†™ç«¯åˆ°ç«¯æµ‹è¯•:
  - éƒ¨ç½²æµ‹è¯•åˆçº¦
  - è§¦å‘äº‹ä»¶
  - éªŒè¯ç´¢å¼•ç»“æœ
  - æŸ¥è¯¢ API
- [ ] æµ‹è¯• Reorg åœºæ™¯
  - æ¨¡æ‹ŸåŒºå—é“¾åˆ†å‰
  - éªŒè¯æ•°æ®å›æ»š
- [ ] æµ‹è¯•æœåŠ¡é—´é€šä¿¡
  - gRPC è°ƒç”¨
  - é”™è¯¯å¤„ç†

**äº¤ä»˜ç‰©:**
- E2E æµ‹è¯•å¥—ä»¶
- é›†æˆæµ‹è¯•æ–‡æ¡£

---

### 6.5 æ€§èƒ½æµ‹è¯•

**ä»»åŠ¡æ¸…å•:**
- [ ] ä½¿ç”¨ k6 ç¼–å†™è´Ÿè½½æµ‹è¯•
- [ ] æµ‹è¯•åœºæ™¯:
  - **API å‹æµ‹**: 1000 QPS æŒç»­ 5 åˆ†é’Ÿ
  - **æ‰¹é‡ç´¢å¼•**: 10000 events/æ‰¹æ¬¡
  - **å¹¶å‘æŸ¥è¯¢**: 100 å¹¶å‘ç”¨æˆ·
- [ ] æµ‹è¯•æ•°æ®åº“æ€§èƒ½
  - ç™¾ä¸‡çº§äº‹ä»¶æŸ¥è¯¢
  - å¤æ‚èšåˆæŸ¥è¯¢
- [ ] æ€§èƒ½ä¼˜åŒ–
  - è¯†åˆ«ç“¶é¢ˆ
  - è°ƒä¼˜å‚æ•°
  - å†æ¬¡æµ‹è¯•

**æ€§èƒ½åŸºå‡†:**
- API P95 < 200ms
- ç´¢å¼•å»¶è¿Ÿ < 5s
- æ•°æ®åº“æŸ¥è¯¢ P99 < 500ms

**äº¤ä»˜ç‰©:**
- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
- ä¼˜åŒ–å»ºè®®æ–‡æ¡£

---

## ğŸš¢ Phase 7: éƒ¨ç½²ä¸æ–‡æ¡£ (Week 4 Day 5-7, Week 5)

### 7.1 å®¹å™¨åŒ–

**ä»»åŠ¡æ¸…å•:**
- [ ] ä¸ºæ¯ä¸ªæœåŠ¡ç¼–å†™ Dockerfile
  - å¤šé˜¶æ®µæ„å»º
  - æœ€å°åŒ–é•œåƒå¤§å°
  - é root ç”¨æˆ·è¿è¡Œ
- [ ] ç¼–å†™ docker-compose ç”Ÿäº§é…ç½®
- [ ] é…ç½®å¥åº·æ£€æŸ¥
- [ ] é…ç½®èµ„æºé™åˆ¶

**é•œåƒä¼˜åŒ–ç›®æ ‡:**
- é•œåƒå¤§å° <50MB (Go binary)
- æ„å»ºæ—¶é—´ <3min

**äº¤ä»˜ç‰©:**
- ç”Ÿäº§çº§ Docker é•œåƒ
- Docker Compose é…ç½®

---

### 7.2 Kubernetes éƒ¨ç½²

**ä»»åŠ¡æ¸…å•:**
- [ ] ç¼–å†™ K8s Manifests:
  - Deployment (æ¯ä¸ªæœåŠ¡)
  - Service (å†…éƒ¨/å¤–éƒ¨)
  - ConfigMap (é…ç½®)
  - Secret (æ•æ„Ÿä¿¡æ¯)
  - HPA (è‡ªåŠ¨æ‰©ç¼©å®¹)
- [ ] é…ç½® Ingress
  - HTTPS
  - è·¯ç”±è§„åˆ™
- [ ] é…ç½®æŒä¹…åŒ–å­˜å‚¨
  - PostgreSQL PVC
  - Redis PVC
- [ ] é…ç½® Namespace éš”ç¦»

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ K8s éƒ¨ç½²é…ç½®
- éƒ¨ç½²è„šæœ¬ (`make deploy`)

---

### 7.3 CI/CD Pipeline

**ä»»åŠ¡æ¸…å•:**
- [ ] é…ç½® GitHub Actions æˆ– GitLab CI
- [ ] å®ç° CI æµç¨‹:
  - ä»£ç æ£€æŸ¥ (golangci-lint)
  - è¿è¡Œæµ‹è¯•
  - æ„å»º Docker é•œåƒ
  - æ¨é€åˆ° Registry
- [ ] å®ç° CD æµç¨‹:
  - è‡ªåŠ¨éƒ¨ç½²åˆ° Staging
  - æ‰‹åŠ¨å®¡æ‰¹éƒ¨ç½²åˆ° Production
- [ ] é…ç½®å›æ»šæœºåˆ¶

**Pipeline é˜¶æ®µ:**
```yaml
stages:
  - lint
  - test
  - build
  - deploy-staging
  - deploy-prod
```

**äº¤ä»˜ç‰©:**
- è‡ªåŠ¨åŒ– CI/CD æµç¨‹
- Pipeline é…ç½®æ–‡ä»¶

---

### 7.4 åŸºç¡€è®¾æ–½å³ä»£ç  (å¯é€‰)

**ä»»åŠ¡æ¸…å•:**
- [ ] ä½¿ç”¨ Terraform å®šä¹‰åŸºç¡€è®¾æ–½
  - AWS ECS/EKS é›†ç¾¤
  - RDS PostgreSQL
  - ElastiCache Redis
  - ALB/NLB
  - VPC ç½‘ç»œ
- [ ] ç¼–å†™ç¯å¢ƒå˜é‡é…ç½®
  - Dev
  - Staging
  - Production
- [ ] å®ç°è“ç»¿éƒ¨ç½²ç­–ç•¥

**äº¤ä»˜ç‰©:**
- Terraform é…ç½®æ–‡ä»¶
- åŸºç¡€è®¾æ–½æ–‡æ¡£

---

### 7.5 API æ–‡æ¡£

**ä»»åŠ¡æ¸…å•:**
- [ ] ç¼–å†™ GraphQL API æ–‡æ¡£
  - Query è¯´æ˜
  - Mutation è¯´æ˜
  - å‚æ•°ç±»å‹å®šä¹‰
  - ç¤ºä¾‹æŸ¥è¯¢
- [ ] é…ç½® GraphQL Playground
  - å…¬å¼€è®¿é—®
  - æ·»åŠ ç¤ºä¾‹æŸ¥è¯¢
- [ ] ç¼–å†™ REST API æ–‡æ¡£ (å¦‚æœæœ‰)
  - Swagger/OpenAPI è§„èŒƒ
  - ç¤ºä¾‹è¯·æ±‚/å“åº”
- [ ] ç¼–å†™ gRPC æ–‡æ¡£
  - Proto æ–‡ä»¶è¯´æ˜
  - æœåŠ¡é—´è°ƒç”¨ç¤ºä¾‹

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„ API å‚è€ƒæ–‡æ¡£
- Postman Collection

---

### 7.6 æ¶æ„æ–‡æ¡£

**ä»»åŠ¡æ¸…å•:**
- [ ] ç¼–å†™æ¶æ„å†³ç­–è®°å½• (ADR)
  - ä¸ºä»€ä¹ˆé€‰æ‹©å¾®æœåŠ¡
  - ä¸ºä»€ä¹ˆé€‰æ‹© GraphQL
  - æ•°æ®åº“ç´¢å¼•ç­–ç•¥é€‰æ‹©
  - ç¼“å­˜ç­–ç•¥é€‰æ‹©
- [ ] ç»˜åˆ¶æ¶æ„å›¾
  - ç³»ç»Ÿæ¶æ„å›¾
  - æ•°æ®æµå›¾
  - éƒ¨ç½²æ¶æ„å›¾
- [ ] ç¼–å†™è¿ç»´æ‰‹å†Œ
  - éƒ¨ç½²æ­¥éª¤
  - æ•…éšœæ’æŸ¥
  - ç›‘æ§æŒ‡æ ‡è¯´æ˜
  - æ‰©å®¹ç­–ç•¥

**äº¤ä»˜ç‰©:**
- å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£
- å¯è§†åŒ–æ¶æ„å›¾

---

### 7.7 ç”¨æˆ·æ–‡æ¡£

**ä»»åŠ¡æ¸…å•:**
- [ ] ç¼–å†™ README.md
  - é¡¹ç›®ç®€ä»‹
  - å¿«é€Ÿå¼€å§‹
  - åŠŸèƒ½ç‰¹æ€§
  - æŠ€æœ¯æ ˆ
- [ ] ç¼–å†™å¼€å‘è€…æŒ‡å—
  - æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º
  - å¦‚ä½•æ·»åŠ æ–°åˆçº¦
  - å¦‚ä½•æ‰©å±•åŠŸèƒ½
- [ ] ç¼–å†™ API ä½¿ç”¨æ•™ç¨‹
  - GraphQL æŸ¥è¯¢ç¤ºä¾‹
  - è®¤è¯è¯´æ˜
  - é™æµè¯´æ˜
- [ ] å½•åˆ¶ Demo è§†é¢‘
  - ç³»ç»Ÿæ¼”ç¤º (5-10åˆ†é’Ÿ)
  - ä»£ç  walkthrough

**äº¤ä»˜ç‰©:**
- ç”¨æˆ·å‹å¥½çš„æ–‡æ¡£
- è§†é¢‘æ•™ç¨‹

---

## âœ… å…³é”®æ£€æŸ¥ç‚¹ (Checkpoints)

### Week 1 ç»“æŸ
**éªŒæ”¶æ ‡å‡†:**
- [ ] Docker Compose ç¯å¢ƒå¯ä¸€é”®å¯åŠ¨
- [ ] Indexer Service èƒ½ç›‘å¬ Ganache ä¸Šçš„æµ‹è¯•åˆçº¦
- [ ] äº‹ä»¶æˆåŠŸå†™å…¥ PostgreSQL
- [ ] èƒ½é€šè¿‡ SQL æŸ¥è¯¢åˆ°äº‹ä»¶æ•°æ®

**Demo æ¼”ç¤º:**
éƒ¨ç½²ä¸€ä¸ª ERC20 åˆçº¦ï¼Œæ‰§è¡Œ Transferï¼ŒæŸ¥çœ‹æ•°æ®åº“ä¸­çš„è®°å½•

---

### Week 2 ç»“æŸ
**éªŒæ”¶æ ‡å‡†:**
- [ ] GraphQL API å¯è®¿é—®
- [ ] èƒ½é€šè¿‡ GraphQL æŸ¥è¯¢äº‹ä»¶
- [ ] Reorg å¤„ç†é€»è¾‘é€šè¿‡æµ‹è¯•
- [ ] åŸºç¡€ç›‘æ§æŒ‡æ ‡å¯è§

**Demo æ¼”ç¤º:**
ä½¿ç”¨ GraphQL Playground æ‰§è¡Œå¤æ‚æŸ¥è¯¢ï¼Œå±•ç¤º Reorg å¤„ç†

---

### Week 3 ç»“æŸ
**éªŒæ”¶æ ‡å‡†:**
- [ ] æ‰€æœ‰å¾®æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] æœåŠ¡é—´ gRPC é€šä¿¡æ­£å¸¸
- [ ] ç¼“å­˜å‘½ä¸­ç‡ >50%
- [ ] API P95 < 300ms (å¯æ¥å—)

**Demo æ¼”ç¤º:**
å±•ç¤ºç®¡ç†åå°ï¼Œè§¦å‘å†å²å›å¡«ï¼ŒæŸ¥çœ‹ç›‘æ§é¢æ¿

---

### Week 4 ç»“æŸ
**éªŒæ”¶æ ‡å‡†:**
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ >75%
- [ ] é›†æˆæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] Grafana Dashboard å®Œå–„

**Demo æ¼”ç¤º:**
å±•ç¤ºæ€§èƒ½æµ‹è¯•ç»“æœï¼Œæ¨¡æ‹Ÿé«˜è´Ÿè½½åœºæ™¯

---

### Week 5 ç»“æŸ (é¡¹ç›®å®Œæˆ)
**éªŒæ”¶æ ‡å‡†:**
- [ ] å¯éƒ¨ç½²åˆ° K8s æˆ–äº‘å¹³å°
- [ ] CI/CD æµç¨‹è¿è¡Œæ­£å¸¸
- [ ] æ–‡æ¡£å®Œå–„
- [ ] Demo è§†é¢‘å½•åˆ¶å®Œæˆ

**Portfolio å±•ç¤º:**
å‡†å¤‡å¥½å‘æ½œåœ¨é›‡ä¸»/å®¢æˆ·å±•ç¤ºé¡¹ç›®

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡ (Success Metrics)

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹å¼ |
|------|------|----------|
| **ç´¢å¼•å»¶è¿Ÿ** | å¹³è¡¡æ¨¡å¼: ~72ç§’, å®æ—¶æ¨¡å¼: ~12ç§’, å®‰å…¨æ¨¡å¼: ~144ç§’ | Prometheus metrics |
| **API å“åº”æ—¶é—´** | P95 <200ms | k6 å‹æµ‹ |
| **ç¼“å­˜å‘½ä¸­ç‡** | >70% | Redis metrics |
| **æµ‹è¯•è¦†ç›–ç‡** | >75% | go test -cover |
| **ç³»ç»Ÿå¯ç”¨æ€§** | >99% | Uptime monitoring |
| **æ•°æ®å‡†ç¡®ç‡** | 99.99% (6å—ç¡®è®¤), 99.9999% (12å—ç¡®è®¤) | ä¸é“¾ä¸Šæ•°æ®å¯¹æ¯” |

---

## ğŸš¨ é£é™©ç¼“è§£è®¡åˆ’

### é«˜ä¼˜å…ˆçº§é£é™©

**1. RPC èŠ‚ç‚¹ä¸ç¨³å®š**
- **ç¼“è§£**: ä½¿ç”¨ Alchemy/Infura å…è´¹å±‚ + 3ä¸ª fallback èŠ‚ç‚¹
- **ç›‘æ§**: RPC è°ƒç”¨å¤±è´¥ç‡ >5% å‘Šè­¦
- **Portfolioé¢„ç®—**: $0/æœˆ (å…è´¹å±‚: Alchemy 300M CU/æœˆ + Infura 100Kè¯·æ±‚/å¤©)
- **ç”Ÿäº§é¢„ç®—**: $50-100/æœˆ (å¦‚éœ€å‡çº§)

**2. Chain Reorg æ•°æ®ä¸¢å¤±**
- **ç¼“è§£**: å¯é…ç½®ç¡®è®¤ç­–ç•¥ï¼ˆé»˜è®¤6å—å¹³è¡¡æ¨¡å¼ï¼Œå¯é€‰1å—å®æ—¶æˆ–12å—å®‰å…¨ï¼‰
- **æµ‹è¯•**: åœ¨ Ganache æ¨¡æ‹Ÿ Reorg åœºæ™¯ï¼Œæµ‹è¯•æ‰€æœ‰ç¡®è®¤ç­–ç•¥
- **ç›‘æ§**: Reorg æ£€æµ‹å‘Šè­¦ + æŒ‰ç¡®è®¤ç­–ç•¥åˆ†ç»„çš„å»¶è¿Ÿç›‘æ§

**3. æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆ**
- **ç¼“è§£**: æ‰¹é‡æ’å…¥ + ç´¢å¼•ä¼˜åŒ– + è¿æ¥æ± 
- **ç›‘æ§**: æ…¢æŸ¥è¯¢æ—¥å¿—
- **æ‰©å±•**: å¿…è¦æ—¶åˆ†è¡¨/åˆ†åº“

---

## ğŸ“š æ¨èå­¦ä¹ èµ„æº

åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦å‚è€ƒ:

- **Go + Ethereum**: https://goethereumbook.org/
- **gqlgen æ–‡æ¡£**: https://gqlgen.com/
- **PostgreSQL æ€§èƒ½ä¼˜åŒ–**: https://www.postgresql.org/docs/
- **Kubernetes å®æˆ˜**: https://kubernetes.io/docs/
- **å¾®æœåŠ¡è®¾è®¡æ¨¡å¼**: "Building Microservices" by Sam Newman

---

## ğŸ‰ é¡¹ç›®å®Œæˆåçš„æ”¶è·

å®Œæˆè¿™ä¸ªé¡¹ç›®åï¼Œæ‚¨å°†èƒ½å¤Ÿå±•ç¤º:

âœ… **ç³»ç»Ÿè®¾è®¡**: å¾®æœåŠ¡æ¶æ„ã€äº‹ä»¶é©±åŠ¨è®¾è®¡
âœ… **åŒºå—é“¾æŠ€æœ¯**: Web3 å¼€å‘ã€æ™ºèƒ½åˆçº¦äº¤äº’
âœ… **åç«¯å·¥ç¨‹**: Go å¾®æœåŠ¡ã€gRPCã€GraphQL
âœ… **æ•°æ®å·¥ç¨‹**: é«˜æ€§èƒ½ç´¢å¼•ã€æŸ¥è¯¢ä¼˜åŒ–
âœ… **DevOps**: Dockerã€K8sã€CI/CD
âœ… **å¯è§‚æµ‹æ€§**: Prometheusã€Grafana ç›‘æ§

è¿™å°†æ˜¯ä¸€ä¸ªéå¸¸äº®çœ¼çš„ Portfolio é¡¹ç›®ï¼ğŸš€

---

## ğŸ“‹ å¿«é€Ÿä»»åŠ¡æ€»è§ˆ

### Week 1: åŸºç¡€è®¾æ–½ + Indexer æ ¸å¿ƒ
- Day 1-3: Mono-repo æ­å»º + å…±äº«æ¨¡å— + Docker ç¯å¢ƒ
- Day 4-7: åŒºå—é“¾è¿æ¥ + äº‹ä»¶è§£æ + æ•°æ®æŒä¹…åŒ–

### Week 2: Indexer å®Œå–„ + API Gateway
- Day 1-3: Reorg å¤„ç† + ç´¢å¼•å™¨ä¸»æµç¨‹æ•´åˆ
- Day 4-7: GraphQL Schema + gRPC å®¢æˆ·ç«¯ + Resolver å®ç°

### Week 3: Query & Admin Services
- Day 1-3: Query Service (gRPCæœåŠ¡ç«¯ + æŸ¥è¯¢ä¼˜åŒ– + ç¼“å­˜)
- Day 4-7: Admin Service (ç®¡ç†API + å›å¡« + é”™è¯¯æ—¥å¿—)

### Week 4: æµ‹è¯•ä¸ä¼˜åŒ–
- Day 1-2: Prometheus + Grafana ç›‘æ§
- Day 3-4: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• + æ€§èƒ½æµ‹è¯•

### Week 5: éƒ¨ç½²ä¸æ–‡æ¡£
- Day 1-2: Docker + K8s éƒ¨ç½²
- Day 3-4: CI/CD Pipeline + åŸºç¡€è®¾æ–½å³ä»£ç 
- Day 5-7: APIæ–‡æ¡£ + æ¶æ„æ–‡æ¡£ + ç”¨æˆ·æ–‡æ¡£ + Demoè§†é¢‘

---

**é¢„è®¡æ€»å·¥æ—¶**: 160-200 å°æ—¶  
**å»ºè®®æŠ•å…¥**: æ¯å¤© 6-8 å°æ—¶ï¼ŒæŒç»­ 5 å‘¨  
**éš¾åº¦è¯„çº§**: â­â­â­â­â˜† (ä¸­é«˜çº§)

---

## ğŸ”® Future Enhancements (Phase 6+)

ä»¥ä¸‹åŠŸèƒ½ä¸åœ¨å½“å‰ Portfolio é¡¹ç›®çš„ MVP èŒƒå›´å†…ï¼Œä½†æ¶æ„å·²é¢„ç•™æ‰©å±•ç©ºé—´ï¼š

### 1. WebSocket å®æ—¶è®¢é˜…
```graphql
type Subscription {
  newEvents(contractAddress: Address): Event!
}
```
**ç”¨é€”**: å®æ—¶æ¨é€æ–°äº‹ä»¶ç»™å®¢æˆ·ç«¯  
**å¤æ‚åº¦**: ä¸­ç­‰ (éœ€è¦ WebSocket æœåŠ¡å™¨ + äº‹ä»¶å¹¿æ’­æœºåˆ¶)  
**ä¼˜å…ˆçº§**: ä½ (Portfolio å±•ç¤ºä¸å¿…è¦)

### 2. å¤šé“¾æ”¯æŒ
- æ”¯æŒ Polygon, BSC, Arbitrum ç­‰ EVM å…¼å®¹é“¾
- ç»Ÿä¸€çš„å¤šé“¾æŸ¥è¯¢æ¥å£
- æŒ‰é“¾åˆ†ç¦»çš„æ•°æ®å­˜å‚¨

### 3. é«˜çº§åˆ†æåŠŸèƒ½
- æ—¶é—´åºåˆ—èšåˆ (æ¯å°æ—¶/æ¯å¤©ç»Ÿè®¡)
- åœ°å€è¡Œä¸ºåˆ†æ (æ´»è·ƒåº¦ã€äº¤æ˜“æ¨¡å¼)
- æ™ºèƒ½åˆçº¦äº¤äº’å›¾è°±

### 4. ä¼ä¸šçº§åŠŸèƒ½
- ç»†ç²’åº¦æƒé™æ§åˆ¶ (RBAC)
- API Key ç®¡ç†é¢æ¿
- æ•°æ®å¯¼å‡º (CSV/JSON)
- Webhook é€šçŸ¥

**å†³ç­–**: Portfolio é¡¹ç›®ä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½å±•ç¤ºï¼Œä»¥ä¸ŠåŠŸèƒ½å¯åœ¨é¢è¯•ä¸­è®¨è®ºæ¶æ„æ‰©å±•æ€§æ—¶æåŠã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-15  
**æ›´æ–°æ—¥æœŸ**: 2025-10-17